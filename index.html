<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Heading 1</h1>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a diam lectus. Sed sit amet ipsum mauris. Maecenas congue ligula ac quam viverra nec consectetur ante hendrerit. Donec et mollis dolor. Praesent et diam eget libero egestas mattis sit amet vitae augue. Nam tincidunt congue enim, ut porta lorem lacinia consectetur. Donec ut libero sed arcu vehicula ultricies a non tortor. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
<p>Donec at sapien sed enim sollicitudin venenatis. Donec a semper dui. Sed

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0; padding: 20px; background: #f5f5f5; border-radius: 8px;">
    <div style="background: white; padding: 20px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h3>ðŸ“… Next Session</h3>
        <p id="nextSession" style="color: #666; font-size: 18px; margin: 10px 0;">Loading...</p>
        <small id="nextSessionDesc" style="color: #999;"></small>
    </div>

    <div style="background: white; padding: 20px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h3>ðŸ“Œ Featured Project</h3>
        <p id="biggestProject" style="color: #666; font-weight: bold; margin: 10px 0;">Loading...</p>
        <small id="biggestProjectDesc" style="color: #999;"></small>
    </div>

    <div style="background: white; padding: 20px; border-radius: 5px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
        <h3>ðŸ’¬ Quick Message</h3>
        <input type="text" id="messengerInput" placeholder="Your message..." style="width: 100%; padding: 8px; margin: 10px 0; box-sizing: border-box; border: 1px solid #ddd; border-radius: 3px;">
        <button onclick="sendMessage()" style="width: 100%; padding: 8px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer;">Send</button>
        <div id="messagesDisplay" style="margin-top: 10px; max-height: 150px; overflow-y: auto; font-size: 12px; color: #666;"></div>
    </div>
</div>

<script src="script.js"></script>
<button onclick="window.location.href = 'sessions.html';">Sessions</button>
<button onclick="window.location.href = 'projects.html';">Current Projects</button>
<button onclick="window.location.href = 'members.html';">Members</button>
<button onclick="window.location.href = 'mailto:twistedhotdawgcoddingclub@gmail.com';">Questions/conserns & Contact us</button>

<script>
    function loadDashboard() {
        // Load next session
        fetch('api.php?action=get&type=sessions')
            .then(res => res.json())
            .then(sessions => {
                if (sessions.length > 0) {
                    const nextSession = sessions[0];
                    document.getElementById('nextSession').textContent = nextSession.date || 'No date set';
                    document.getElementById('nextSessionDesc').textContent = nextSession.name;
                } else {
                    document.getElementById('nextSession').textContent = 'No sessions scheduled';
                }
            })
            .catch(err => console.error('Error loading sessions:', err));

        // Load biggest/featured project
        fetch('api.php?action=get&type=projects')
            .then(res => res.json())
            .then(projects => {
                if (projects.length > 0) {
                    const biggestProject = projects.reduce((max, p) => 
                        (p.desc?.length || 0) > (max.desc?.length || 0) ? p : max
                    );
                    document.getElementById('biggestProject').textContent = biggestProject.name;
                    document.getElementById('biggestProjectDesc').textContent = 
                        (biggestProject.desc || '').substring(0, 80) + (biggestProject.desc?.length > 80 ? '...' : '');
                } else {
                    document.getElementById('biggestProject').textContent = 'No projects yet';
                }
            })
            .catch(err => console.error('Error loading projects:', err));

        // Load messages
        loadMessages();
    }

    function loadMessages() {
        const stored = localStorage.getItem('dashboardMessages') || '[]';
        const messages = JSON.parse(stored);
        const display = document.getElementById('messagesDisplay');
        display.innerHTML = messages.map(msg => `<div style="padding: 5px; border-bottom: 1px solid #eee;">${escapeHtml(msg)}</div>`).join('');
        display.scrollTop = display.scrollHeight;
    }

    function sendMessage() {
        const input = document.getElementById('messengerInput');
        const msg = input.value.trim();
        if (!msg) return;

        const stored = localStorage.getItem('dashboardMessages') || '[]';
        const messages = JSON.parse(stored);
        messages.push(msg);
        localStorage.setItem('dashboardMessages', JSON.stringify(messages.slice(-10))); // Keep last 10
        input.value = '';
        loadMessages();
    }

    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    // Load dashboard on page load
    loadDashboard();
    setInterval(loadDashboard, 30000); // Refresh every 30 seconds
</script>
</body>
</html>